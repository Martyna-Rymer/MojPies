import{_ as A,e as _,j as B,f as N,r as w,o as y,c as g,a,t as u,F as D,m as S,b as v,w as z,q as F,k as I}from"./index-68f86edd.js";import{t as j,e as O,a as f,d as k,b as M,f as U,S as V,D as $}from"./index-ce0dfd1e.js";import{N as L}from"./NavBarComponent-c9098a72.js";const P={components:{NavBarComponent:L},setup(){const h=_([]),d=_(null),p=_(!1),o=_(!1),b=B(()=>{let e=h.value;return p.value&&(e=e.filter(s=>new Date(s.date.toMillis())>=new Date)),o.value&&(e=e.filter(s=>s.userAttends)),e.sort((s,t)=>{const n=new Date(s.date.toMillis()),c=new Date(t.date.toMillis());return n-c}),e});N(async()=>{const e=await j(O(k,"events")),s=[];if(f.currentUser){d.value=f.currentUser.uid;const t=f.currentUser.uid;for(const n of e.docs){const c=n.data().attendees.map(l=>l.id),i={id:n.id,type:n.data().type,location:n.data().location,date:n.data().date,attendees:n.data().attendees,userAttends:c.includes(t)};s.push(i)}h.value=s}});function E(e){const s=new Date(e.toMillis()),t=["Niedziela","Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota"],n=["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","września","października","listopada","grudnia"],c=t[s.getDay()],i=s.getDate(),l=n[s.getMonth()],r=s.getFullYear(),x=s.getHours(),C=s.getMinutes();return`${c}, ${i} ${l} ${r} ${x.toString().padStart(2,"0")}:${C.toString().padStart(2,"0")}`}async function m(e){if(f.currentUser){const t=f.currentUser.uid,n=M(k,"users",t),i=e.attendees.map(r=>r.id).indexOf(t),l=M(k,"events",e.id);i===-1?(e.attendees.push(n),e.userAttends=!0,await U(l,{attendees:V(n)}).then(()=>{console.log("User added to attendees array")}).catch(r=>{console.error(r)})):(e.attendees.splice(i,1),e.userAttends=!1,await U(l,{attendees:$(n)}).then(()=>{console.log("User removed from attendees array")}).catch(r=>{console.error(r)}));var s=new Audio("/MojPies/bark.mp3");s.play()}}return{formatDate:E,attendEvent:m,filteredEvents:b,showFutureEvents:p,showUserEvents:o}}},q={class:"container",style:{"margin-bottom":"100px"}},R={class:"d-flex justify-content-between mb-3"},W={class:"row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4"},H={class:"card h-100 shadow"},Y={class:"card-body"},G={class:"card-title"},J={class:"card-text"},K={class:"card-footer d-flex justify-content-between align-items-center"},Q=["onClick"];function T(h,d,p,o,b,E){const m=w("router-link"),e=w("font-awesome-icon"),s=w("NavBarComponent");return y(),g(D,null,[a("div",q,[a("div",R,[a("button",{onClick:d[0]||(d[0]=t=>o.showFutureEvents=!o.showFutureEvents),class:"filter-button"},u(o.showFutureEvents?"✔️ Nadchodzące":"Nadchodzące"),1),a("button",{onClick:d[1]||(d[1]=t=>o.showUserEvents=!o.showUserEvents),class:"filter-button"},u(o.showUserEvents?"✔️ Biorę udział":"Biorę udział"),1)]),a("div",W,[(y(!0),g(D,null,S(o.filteredEvents,t=>(y(),g("div",{key:t.id,class:"col"},[v(m,{to:{name:"event",params:{key:t.id}}},{default:z(()=>[a("div",H,[a("div",Y,[a("h5",G,u(t.type)+" - "+u(t.location),1),a("p",J,u(o.formatDate(t.date)),1)]),a("div",K,[a("button",{class:F({attended:t.userAttends,"not-attended":!t.userAttends}),onClick:I(n=>o.attendEvent(t),["prevent"])},u(t.userAttends?"Opuść":"Dołącz"),11,Q)])])]),_:2},1032,["to"])]))),128))]),v(m,{to:"/newevent",class:"add-event-button"},{default:z(()=>[v(e,{icon:["fas","plus"]})]),_:1})]),v(s)],64)}const et=A(P,[["render",T]]);export{et as default};
