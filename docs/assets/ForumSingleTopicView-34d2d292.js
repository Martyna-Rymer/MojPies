import{_ as B,f as y,h as U,u as j,r as R,o as m,c as _,a,t as d,b as D,w as M,d as p,F as N,k as F,j as P,v as J,e as K}from"./index-48392637.js";import{J as k,a as T,d as S,g as I,r as A,s as C,e as V,f as L,S as $}from"./index-3872b343.js";import{N as E}from"./NavBarComponent-4c989270.js";const H="/MojPies/assets/send_h-38d532ee.png";const O={components:{NavBarComponent:E},setup(){const i=y(""),n=y(),l=y(),e=r=>{const t=new Date(r.toMillis()),c=String(t.getDate()).padStart(2,"0"),s=String(t.getMonth()+1).padStart(2,"0"),g=t.getFullYear(),u=String(t.getHours()).padStart(2,"0"),v=String(t.getMinutes()).padStart(2,"0");return`${c}.${s}.${g} ${u}:${v}`},w=async r=>{const t=await k(r);return{name:t.data().name,id:t.id}};U(async()=>{const r=j();l.value=`forum/${r.params.sectionKey}/threads/${r.params.threadId}`;let t;const c=await k(T(S,`forum/${r.params.sectionKey}/threads/${r.params.threadId}`)),s=c.data(),g=s.answers.map(async o=>{const h=await w(o.author);return await I(A(C,`images/${h.id}`)).then(b=>{t=b}).catch(b=>{t="/MojPies/profile.png"}),{date:o.date,answer:o.answer,authorName:h.name,authorId:h.id,imageSrc:t}}).sort((o,h)=>new Date(o.date)-new Date(h.date)),u=await w(s.authorRef);await I(A(C,`images/${u.id}`)).then(o=>{t=o}).catch(o=>{t="/MojPies/profile.png"});const v={id:c.id,threadTopic:s.topic,threadDescription:s.description,threadAuthor:u,threadAuthorImg:t,threadStartDate:s.date,answers:await Promise.all(g)};n.value=v});const x=async()=>{const r=T(S,l.value);if(V.currentUser){const c=V.currentUser.uid,s=T(S,"users",c);await L(r,{answers:$({answer:i.value,date:new Date,author:s})});var t=new Audio("/MojPies/bark.mp3");t.play(),i.value="",window.location.reload()}};return{currentThread:n,formatDate:e,threadResponse:i,submitThreadResponse:async()=>{i.value.trim()!==""&&await x()},path:l}}},Y={key:0,class:"container"},q={class:"card mb-3",style:{width:"100%"}},z={class:"card-body"},G={class:"card-title"},Q={class:"card-text"},W={class:"card-text"},X=["src"],Z={class:"text-muted"},tt={class:"card mb-3",style:{width:"100%"}},at={class:"card-body"},et={class:"card-text"},rt={class:"card-text"},st=["src"],ot={class:"text-muted"},nt=a("hr",{class:"m-0"},null,-1),dt={class:"card mb-3",style:{width:"100%"}},ct={class:"card-body"};function it(i,n,l,e,w,x){const f=R("router-link"),r=R("NavBarComponent");return m(),_(N,null,[e.currentThread?(m(),_("div",Y,[a("div",q,[a("div",z,[a("h5",G,d(e.currentThread.threadTopic),1),a("p",Q,d(e.currentThread.threadDescription),1),a("p",W,[D(f,{to:{name:"profile",params:{userId:e.currentThread.threadAuthor.id}}},{default:M(()=>[a("img",{src:e.currentThread.threadAuthorImg,class:"user-avatar rounded-circle",alt:"User avatar"},null,8,X),p(" "+d(e.currentThread.threadAuthor.name),1)]),_:1},8,["to"]),p(", "),a("small",Z,d(e.formatDate(e.currentThread.threadStartDate)),1)])])]),(m(!0),_(N,null,F(e.currentThread.answers,t=>(m(),_("div",tt,[a("div",at,[a("p",et,d(t.answer),1),a("p",rt,[D(f,{to:{name:"profile",params:{userId:t.authorId}}},{default:M(()=>[a("img",{src:t.imageSrc,class:"user-avatar rounded-circle",alt:"User avatar"},null,8,st),p(" "+d(t.authorName),1)]),_:2},1032,["to"]),p(", "),a("small",ot,d(e.formatDate(t.date)),1)])]),nt]))),256)),a("div",dt,[a("div",ct,[P(a("textarea",{"onUpdate:modelValue":n[0]||(n[0]=t=>e.threadResponse=t),class:"form-control w-100"},null,512),[[J,e.threadResponse]]),a("img",{class:"mt-3 d-block mx-auto",src:H,width:"150",onClick:n[1]||(n[1]=(...t)=>e.submitThreadResponse&&e.submitThreadResponse(...t))})])])])):K("",!0),D(r)],64)}const mt=B(O,[["render",it]]);export{mt as default};
