import{_ as C,e as m,n as M,f as A,r as p,o as y,c as k,a,t as u,F as D,l as B,b as v,w as z,q as N,j as F}from"./index-6c94c931.js";import{t as I,e as j,a as f,d as b,b as U,f as x,S,D as O}from"./index-ce0dfd1e.js";import{N as V}from"./NavBarComponent-85ae382c.js";const L={components:{NavBarComponent:V},setup(){const w=m([]),d=m(null),h=m(!1),o=m(!1),E=M(()=>{let t=w.value;return h.value&&(t=t.filter(s=>new Date(s.date.toMillis())>=new Date)),o.value&&(t=t.filter(s=>s.userAttends)),t.sort((s,e)=>{const n=new Date(s.date.toMillis()),c=new Date(e.date.toMillis());return n-c}),t});A(async()=>{const t=await I(j(b,"events")),s=[];if(f.currentUser){d.value=f.currentUser.uid;const e=f.currentUser.uid;for(const n of t.docs){const c=n.data().attendees.map(l=>l.id),i={id:n.id,type:n.data().type,location:n.data().location,date:n.data().date,attendees:n.data().attendees,userAttends:c.includes(e)};s.push(i)}w.value=s}});function g(t){const s=new Date(t.toMillis()),e=["Niedziela","Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota"],n=["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","września","października","listopada","grudnia"],c=e[s.getDay()],i=s.getDate(),l=n[s.getMonth()],r=s.getFullYear();return`${c}, ${i} ${l} ${r}`}async function _(t){if(f.currentUser){const e=f.currentUser.uid,n=U(b,"users",e),i=t.attendees.map(r=>r.id).indexOf(e),l=U(b,"events",t.id);i===-1?(t.attendees.push(n),t.userAttends=!0,await x(l,{attendees:S(n)}).then(()=>{console.log("User added to attendees array")}).catch(r=>{console.error(r)})):(t.attendees.splice(i,1),t.userAttends=!1,await x(l,{attendees:O(n)}).then(()=>{console.log("User removed from attendees array")}).catch(r=>{console.error(r)}));var s=new Audio("/MojPies/bark.mp3");s.play()}}return{formatDate:g,attendEvent:_,filteredEvents:E,showFutureEvents:h,showUserEvents:o}}},P={class:"container",style:{"margin-bottom":"100px"}},q={class:"d-flex justify-content-between mb-3"},R={class:"row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4"},W={class:"card h-100 shadow"},$={class:"card-body"},Y={class:"card-title"},G={class:"card-text"},H={class:"card-footer d-flex justify-content-between align-items-center"},J=["onClick"];function K(w,d,h,o,E,g){const _=p("router-link"),t=p("font-awesome-icon"),s=p("NavBarComponent");return y(),k(D,null,[a("div",P,[a("div",q,[a("button",{onClick:d[0]||(d[0]=e=>o.showFutureEvents=!o.showFutureEvents),class:"filter-button"},u(o.showFutureEvents?"✔️ Nadchodzące":"Nadchodzące"),1),a("button",{onClick:d[1]||(d[1]=e=>o.showUserEvents=!o.showUserEvents),class:"filter-button"},u(o.showUserEvents?"✔️ Biorę udział":"Biorę udział"),1)]),a("div",R,[(y(!0),k(D,null,B(o.filteredEvents,e=>(y(),k("div",{key:e.id,class:"col"},[v(_,{to:{name:"event",params:{key:e.id}}},{default:z(()=>[a("div",W,[a("div",$,[a("h5",Y,u(e.type)+" - "+u(e.location),1),a("p",G,u(o.formatDate(e.date)),1)]),a("div",H,[a("button",{class:N({attended:e.userAttends,"not-attended":!e.userAttends}),onClick:F(n=>o.attendEvent(e),["prevent"])},u(e.userAttends?"Opuść":"Dołącz"),11,J)])])]),_:2},1032,["to"])]))),128))]),v(_,{to:"/newevent",class:"add-event-button"},{default:z(()=>[v(t,{icon:["fas","plus"]})]),_:1})]),v(s)],64)}const Z=C(L,[["render",K]]);export{Z as default};
