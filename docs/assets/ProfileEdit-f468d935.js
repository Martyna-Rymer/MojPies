import{a as h,g as B,r as b,s as D,u as j,J as F,b as k,d as U,c as N}from"./index-ce0dfd1e.js";import{_ as V,e as _,f as x,o as l,c,a as e,g as P,p as S,h as R,i as z,u as E,j as M,r as C,b as I,k as O,l as m,v as p,F as y,m as w,n as L}from"./index-20bd2023.js";import{N as A}from"./NavBarComponent-ea935c1a.js";const J={setup(){const i=_(),t=_();return x(async()=>{if(h.currentUser){i.value=h.currentUser.uid;const s=document.getElementById("profile-image");B(b(D,`images/${h.currentUser.uid}`)).then(o=>{s.setAttribute("src",o)}).catch(o=>{s.setAttribute("src","/public/profile.png")})}}),{file:t,userId:i}},methods:{onFileSelected:function(i){this.file=i.target.files[0],console.log(this.file);let t=URL.createObjectURL(this.file);document.getElementById("profile-image").setAttribute("src",t)},uploadFile:function(){const i=b(D,`images/${this.userId}`);j(i,this.file).then(t=>{console.log("Załadowano plik")}),this.file=null}}},Z=i=>(S("data-v-68de93d7"),i=i(),R(),i),q={class:"text-center"},T=Z(()=>e("div",{class:"text-center"},[e("img",{id:"profile-image",class:"card-img-top user-avatar rounded-circle mb-3"})],-1));function G(i,t,s,o,v,d){return l(),c("div",q,[T,e("input",{type:"file",onChange:t[0]||(t[0]=(...u)=>d.onFileSelected&&d.onFileSelected(...u))},null,32),o.file?(l(),c("button",{key:0,onClick:t[1]||(t[1]=(...u)=>d.uploadFile&&d.uploadFile(...u))},"Zapisz zdjęcie")):P("",!0)])}const H=V(J,[["render",G],["__scopeId","data-v-68de93d7"]]),K="/MojPies/assets/save_h-e6fdb895.png",Q={components:{NavBarComponent:A,ImagePicker:H},setup(){const i=_(),t=_(),s=z({id:null,name:"",city:"",description:"",favourites:[],dogs:[]});x(async()=>{const n=E();console.log(n.params.userId),i.value=n.params.userId;const f=(await F(k(U,`users/${n.params.userId}`))).data();s.id=n.params.userId,s.name=f.name,s.city=f.city,s.description=f.description,s.favourites=f.favourites||[],s.dogs=f.dogs||[]});const o=()=>{s.dogs.push({name:"",yearOfBirth:"",race:""})},v=n=>{s.dogs.splice(n,1)},d=()=>{s.favourites.push("")},u=n=>{s.favourites.splice(n,1)},g=M(()=>s.name!="");async function a(){const n=k(U,"users",i.value);if(s.name!="")try{await N(n,{name:s.name,city:s.city,description:s.description,favourites:s.favourites,dogs:s.dogs}),console.log("Changes saved successfully!"),L.push({name:"profile",params:{userId:i.value}})}catch(r){console.log("Error saving changes: ",r)}else alert("Proszę wypełnić wymagane pola")}return{userId:i,initialUrl:t,profileData:s,addDog:o,removeDog:v,addPlace:d,removePlace:u,saveChanges:a,isFormValid:g}}},W={class:"container ml-2 me-2",style:{"margin-bottom":"70px"}},X={key:0},Y={class:"form-group mt-3"},$=e("label",{for:"profileData.userName"},"Nazwa użytkownika *",-1),ee={class:"form-group mt-3"},oe=e("label",{for:"profileData.city"},"Miejscowość",-1),te={class:"form-group mt-3"},se=e("label",{for:"profileData.description"},"Opis",-1),ae={class:"form-group mt-3"},ne=e("label",{for:"profileData.favourite-places"},"Ulubione miejsca na wyjścia z psem",-1),ie={class:"form-row"},re={class:"col"},le=["onUpdate:modelValue"],ce={class:"col-auto"},de=["onClick"],ue={class:"form-group mt-3"},me=e("label",{for:"dogs"},"Psy",-1),pe={class:"form-row"},fe={class:"col"},_e=["onUpdate:modelValue"],ve={class:"col"},ge=["onUpdate:modelValue"],he={class:"col"},ye=["onUpdate:modelValue"],be={class:"col-auto"},De=["onClick"],ke=["disabled"];function Ue(i,t,s,o,v,d){const u=C("ImagePicker"),g=C("NavBarComponent");return l(),c(y,null,[e("div",W,[o.profileData?(l(),c("div",X,[I(u),e("form",{onSubmit:t[6]||(t[6]=O((...a)=>o.saveChanges&&o.saveChanges(...a),["prevent"]))},[e("div",Y,[$,m(e("input",{type:"text",class:"form-control",id:"name","onUpdate:modelValue":t[0]||(t[0]=a=>o.profileData.name=a),required:""},null,512),[[p,o.profileData.name]])]),e("div",ee,[oe,m(e("input",{type:"text",class:"form-control",id:"city","onUpdate:modelValue":t[1]||(t[1]=a=>o.profileData.city=a)},null,512),[[p,o.profileData.city]])]),e("div",te,[se,m(e("textarea",{class:"form-control",id:"description",rows:"3","onUpdate:modelValue":t[2]||(t[2]=a=>o.profileData.description=a)},null,512),[[p,o.profileData.description]])]),e("div",ae,[ne,(l(!0),c(y,null,w(o.profileData.favourites,(a,n)=>(l(),c("div",{key:n},[e("div",ie,[e("div",re,[m(e("input",{type:"text",class:"form-control","onUpdate:modelValue":r=>o.profileData.favourites[n]=r},null,8,le),[[p,o.profileData.favourites[n]]])]),e("div",ce,[e("button",{type:"button",class:"btn btn-danger",onClick:r=>o.removePlace(n)},"Usuń",8,de)])])]))),128)),e("div",null,[e("button",{type:"button",class:"btn btn-success mt-2",onClick:t[3]||(t[3]=(...a)=>o.addPlace&&o.addPlace(...a))},"Dodaj miejsce")])]),e("div",ue,[me,(l(!0),c(y,null,w(o.profileData.dogs,(a,n)=>(l(),c("div",{key:n},[e("div",pe,[e("div",fe,[m(e("input",{type:"text",class:"form-control",placeholder:"Imię","onUpdate:modelValue":r=>a.name=r},null,8,_e),[[p,a.name]])]),e("div",ve,[m(e("input",{type:"text",class:"form-control",placeholder:"Rok urodzenia","onUpdate:modelValue":r=>a.yearOfBirth=r},null,8,ge),[[p,a.yearOfBirth]])]),e("div",he,[m(e("input",{type:"text",class:"form-control",placeholder:"Rasa","onUpdate:modelValue":r=>a.race=r},null,8,ye),[[p,a.race]])]),e("div",be,[e("button",{type:"button",class:"btn btn-danger",onClick:r=>o.removeDog(n)},"Usuń",8,De)])])]))),128)),e("div",null,[e("button",{type:"button",class:"btn btn-success mt-2",onClick:t[4]||(t[4]=(...a)=>o.addDog&&o.addDog(...a))},"Dodaj psa")])]),e("button",{type:"submit",disabled:!o.isFormValid,class:"d-block mx-auto mt-3"},[e("img",{src:K,width:"150",onClick:t[5]||(t[5]=(...a)=>o.saveChanges&&o.saveChanges(...a))})],8,ke)],32)])):P("",!0)]),I(g)],64)}const Ve=V(Q,[["render",Ue]]);export{Ve as default};
