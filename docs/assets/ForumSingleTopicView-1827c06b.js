import{_ as j,f as m,h as F,u as P,r as M,o as g,c as w,a as e,t as d,b as S,w as N,d as v,F as k,k as K,j as J,v as L,e as $,s as E}from"./index-ac1b3563.js";import{J as A,a as x,d as b,g as C,r as U,s as V,e as B,f as H,S as O}from"./index-3872b343.js";import{N as Y}from"./NavBarComponent-cca47922.js";const q="/MojPies/assets/send_h-38d532ee.png";const z={components:{NavBarComponent:Y},setup(){const h=m(""),c=m(),_=m(),t=m(),y=m(),I=s=>{const a=new Date(s.toMillis()),i=String(a.getDate()).padStart(2,"0"),o=String(a.getMonth()+1).padStart(2,"0"),p=a.getFullYear(),f=String(a.getHours()).padStart(2,"0"),T=String(a.getMinutes()).padStart(2,"0");return`${i}.${o}.${p} ${f}:${T}`},l=async s=>{const a=await A(s);return{name:a.data().name,id:a.id}};F(async()=>{const s=P();_.value=`forum/${s.params.sectionKey}/threads/${s.params.threadId}`,t.value=s.params.sectionKey,y.value=s.params.threadId;let a;const i=await A(x(b,`forum/${s.params.sectionKey}/threads/${s.params.threadId}`)),o=i.data(),p=o.answers.map(async n=>{const u=await l(n.author);return await C(U(V,`images/${u.id}`)).then(R=>{a=R}).catch(R=>{a="/MojPies/profile.png"}),{date:n.date,answer:n.answer,authorName:u.name,authorId:u.id,imageSrc:a}}).sort((n,u)=>new Date(n.date)-new Date(u.date)),f=await l(o.authorRef);await C(U(V,`images/${f.id}`)).then(n=>{a=n}).catch(n=>{a="/MojPies/profile.png"});const T={id:i.id,threadTopic:o.topic,threadDescription:o.description,threadAuthor:f,threadAuthorImg:a,threadStartDate:o.date,answers:await Promise.all(p)};c.value=T});const D=async()=>{const s=x(b,_.value);if(B.currentUser){const i=B.currentUser.uid,o=x(b,"users",i);await H(s,{answers:O({answer:h.value,date:new Date,author:o})});var a=new Audio("/MojPies/bark.mp3");a.play(),h.value="",console.log(t),E().proxy.forceUpdate()}};return{currentThread:c,formatDate:I,threadResponse:h,submitThreadResponse:async()=>{h.value.trim()!==""&&await D()},path:_,sectionKey:t,threadId:y}}},G={key:0,class:"container"},Q={class:"card mb-3",style:{width:"100%"}},W={class:"card-body"},X={class:"card-title"},Z={class:"card-text"},tt={class:"card-text"},at=["src"],et={class:"text-muted"},st={class:"card mb-3",style:{width:"100%"}},rt={class:"card-body"},ot={class:"card-text"},nt={class:"card-text"},ct=["src"],dt={class:"text-muted"},it=e("hr",{class:"m-0"},null,-1),ht={class:"card mb-3",style:{width:"100%"}},lt={class:"card-body"};function ut(h,c,_,t,y,I){const l=M("router-link"),D=M("NavBarComponent");return g(),w(k,null,[t.currentThread?(g(),w("div",G,[e("div",Q,[e("div",W,[e("h5",X,d(t.currentThread.threadTopic),1),e("p",Z,d(t.currentThread.threadDescription),1),e("p",tt,[S(l,{to:{name:"profile",params:{userId:t.currentThread.threadAuthor.id}}},{default:N(()=>[e("img",{src:t.currentThread.threadAuthorImg,class:"user-avatar rounded-circle",alt:"User avatar"},null,8,at),v(" "+d(t.currentThread.threadAuthor.name),1)]),_:1},8,["to"]),v(", "),e("small",et,d(t.formatDate(t.currentThread.threadStartDate)),1)])])]),(g(!0),w(k,null,K(t.currentThread.answers,r=>(g(),w("div",st,[e("div",rt,[e("p",ot,d(r.answer),1),e("p",nt,[S(l,{to:{name:"profile",params:{userId:r.authorId}}},{default:N(()=>[e("img",{src:r.imageSrc,class:"user-avatar rounded-circle",alt:"User avatar"},null,8,ct),v(" "+d(r.authorName),1)]),_:2},1032,["to"]),v(", "),e("small",dt,d(t.formatDate(r.date)),1)])]),it]))),256)),e("div",ht,[e("div",lt,[J(e("textarea",{"onUpdate:modelValue":c[0]||(c[0]=r=>t.threadResponse=r),class:"form-control w-100"},null,512),[[L,t.threadResponse]]),e("img",{class:"mt-3 d-block mx-auto",src:q,width:"150",onClick:c[1]||(c[1]=(...r)=>t.submitThreadResponse&&t.submitThreadResponse(...r))})])])])):$("",!0),S(D)],64)}const ft=j(z,[["render",ut]]);export{ft as default};
