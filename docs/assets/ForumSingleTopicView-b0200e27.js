import{_ as j,f as m,h as F,u as K,r as M,o as f,c as g,a as e,t as c,b as S,w as N,d as v,F as k,k as P,j as J,v as L,e as $}from"./index-9e986ee2.js";import{J as A,a as x,d as b,g as C,r as V,s as B,e as U,f as E,S as H}from"./index-3872b343.js";import{N as O}from"./NavBarComponent-6ced727a.js";const Y="/MojPies/assets/send_h-38d532ee.png";const q={components:{NavBarComponent:O},setup(){const h=m(""),d=m(),_=m(),t=m(),p=m(),I=r=>{const a=new Date(r.toMillis()),i=String(a.getDate()).padStart(2,"0"),o=String(a.getMonth()+1).padStart(2,"0"),T=a.getFullYear(),w=String(a.getHours()).padStart(2,"0"),D=String(a.getMinutes()).padStart(2,"0");return`${i}.${o}.${T} ${w}:${D}`},l=async r=>{const a=await A(r);return{name:a.data().name,id:a.id}};F(async()=>{const r=K();_.value=`forum/${r.params.sectionKey}/threads/${r.params.threadId}`,t.value=r.params.sectionKey,p.value=r.params.threadId;let a;const i=await A(x(b,`forum/${r.params.sectionKey}/threads/${r.params.threadId}`)),o=i.data(),T=o.answers.map(async n=>{const u=await l(n.author);return await C(V(B,`images/${u.id}`)).then(R=>{a=R}).catch(R=>{a="/MojPies/profile.png"}),{date:n.date,answer:n.answer,authorName:u.name,authorId:u.id,imageSrc:a}}).sort((n,u)=>new Date(n.date)-new Date(u.date)),w=await l(o.authorRef);await C(V(B,`images/${w.id}`)).then(n=>{a=n}).catch(n=>{a="/MojPies/profile.png"});const D={id:i.id,threadTopic:o.topic,threadDescription:o.description,threadAuthor:w,threadAuthorImg:a,threadStartDate:o.date,answers:await Promise.all(T)};d.value=D});const y=async()=>{const r=x(b,_.value);if(U.currentUser){const i=U.currentUser.uid,o=x(b,"users",i);await E(r,{answers:H({answer:h.value,date:new Date,author:o})});var a=new Audio("/MojPies/bark.mp3");a.play(),h.value="",console.log(t),window.location.reload(),router.push({name:"forumThread",params:{sectionKey:t,threadId:p}})}};return{currentThread:d,formatDate:I,threadResponse:h,submitThreadResponse:async()=>{h.value.trim()!==""&&await y()},path:_,sectionKey:t,threadId:p}}},z={key:0,class:"container"},G={class:"card mb-3",style:{width:"100%"}},Q={class:"card-body"},W={class:"card-title"},X={class:"card-text"},Z={class:"card-text"},tt=["src"],at={class:"text-muted"},et={class:"card mb-3",style:{width:"100%"}},rt={class:"card-body"},st={class:"card-text"},ot={class:"card-text"},nt=["src"],dt={class:"text-muted"},ct=e("hr",{class:"m-0"},null,-1),it={class:"card mb-3",style:{width:"100%"}},ht={class:"card-body"};function lt(h,d,_,t,p,I){const l=M("router-link"),y=M("NavBarComponent");return f(),g(k,null,[t.currentThread?(f(),g("div",z,[e("div",G,[e("div",Q,[e("h5",W,c(t.currentThread.threadTopic),1),e("p",X,c(t.currentThread.threadDescription),1),e("p",Z,[S(l,{to:{name:"profile",params:{userId:t.currentThread.threadAuthor.id}}},{default:N(()=>[e("img",{src:t.currentThread.threadAuthorImg,class:"user-avatar rounded-circle",alt:"User avatar"},null,8,tt),v(" "+c(t.currentThread.threadAuthor.name),1)]),_:1},8,["to"]),v(", "),e("small",at,c(t.formatDate(t.currentThread.threadStartDate)),1)])])]),(f(!0),g(k,null,P(t.currentThread.answers,s=>(f(),g("div",et,[e("div",rt,[e("p",st,c(s.answer),1),e("p",ot,[S(l,{to:{name:"profile",params:{userId:s.authorId}}},{default:N(()=>[e("img",{src:s.imageSrc,class:"user-avatar rounded-circle",alt:"User avatar"},null,8,nt),v(" "+c(s.authorName),1)]),_:2},1032,["to"]),v(", "),e("small",dt,c(t.formatDate(s.date)),1)])]),ct]))),256)),e("div",it,[e("div",ht,[J(e("textarea",{"onUpdate:modelValue":d[0]||(d[0]=s=>t.threadResponse=s),class:"form-control w-100"},null,512),[[L,t.threadResponse]]),e("img",{class:"mt-3 d-block mx-auto",src:Y,width:"150",onClick:d[1]||(d[1]=(...s)=>t.submitThreadResponse&&t.submitThreadResponse(...s))})])])])):$("",!0),S(y)],64)}const pt=j(q,[["render",lt]]);export{pt as default};
