import{a as h,g as F,r as I,s as w,u as N,J as x,b as D,d as U,c as S}from"./index-ce0dfd1e.js";import{_ as j,e as _,f as R,o as i,c as r,a as o,g as C,p as z,h as O,i as E,u as M,j as L,r as B,b as P,k as A,l as c,v as d,F as v,m as k,n as J}from"./index-dcd09675.js";import{N as Z}from"./NavBarComponent-82bb9565.js";const q={setup(){const n=_(),s=_();return R(async()=>{if(h.currentUser){n.value=h.currentUser.uid;const u=document.getElementById("profile-image");F(I(w,`images/${h.currentUser.uid}`)).then(e=>{u.setAttribute("src",e)}).catch(e=>{u.setAttribute("src","/public/profile.png")})}}),{file:s,userId:n}},methods:{onFileSelected:function(n){this.file=n.target.files[0],console.log(this.file);let s=URL.createObjectURL(this.file);document.getElementById("profile-image").setAttribute("src",s)},uploadFile:function(){const n=I(w,`images/${this.userId}`);N(n,this.file).then(s=>{console.log("Załadowano plik")}),this.file=null}}},T=n=>(z("data-v-0225f772"),n=n(),O(),n),G={class:"text-center"},H=T(()=>o("div",{class:"text-center"},[o("img",{id:"profile-image",class:"card-img-top user-avatar rounded-circle mb-3"})],-1));function K(n,s,u,e,g,m){return i(),r("div",G,[H,o("input",{type:"file",onChange:s[0]||(s[0]=(...p)=>m.onFileSelected&&m.onFileSelected(...p))},null,32),e.file?(i(),r("button",{key:0,onClick:s[1]||(s[1]=(...p)=>m.uploadFile&&m.uploadFile(...p))},"Zapisz zdjęcie")):C("",!0)])}const Q=j(q,[["render",K],["__scopeId","data-v-0225f772"]]),W="/MojPies/assets/save_h-e6fdb895.png",X={components:{NavBarComponent:Z,ImagePicker:Q},setup(){const n=_(),s=_(),u=_(),e=E({id:null,name:"",city:"",description:"",favourites:[],dogs:[]});R(async()=>{const a=M();console.log(a.params.userId),n.value=a.params.userId;const f=(await x(D(U,`users/${a.params.userId}`))).data();e.id=a.params.userId,e.name=f.name,e.city=f.city,e.description=f.description,e.favourites=f.favourites||[],e.dogs=f.dogs||[],x(D(U,"users",h.currentUser.uid)).then(b=>{b.exists()?u.value=!0:u.value=!1}).catch(b=>{console.log(b)})});const g=()=>{e.dogs.push({name:"",yearOfBirth:"",race:""})},m=a=>{e.dogs.splice(a,1)},p=()=>{e.favourites.push("")},y=a=>{e.favourites.splice(a,1)},t=L(()=>e.name!="");async function l(){const a=D(U,"users",n.value);if(e.name!="")try{await S(a,{name:e.name,city:e.city,description:e.description,favourites:e.favourites,dogs:e.dogs}),console.log("Changes saved successfully!"),J.push({name:"profile",params:{userId:n.value}})}catch(V){console.log("Error saving changes: ",V)}else alert("Proszę wypełnić wymagane pola")}return{userId:n,initialUrl:s,profileData:e,addDog:g,removeDog:m,addPlace:p,removePlace:y,saveChanges:l,isFormValid:t,isUserRegistered:u}}},Y={class:"container ml-2 me-2",style:{"margin-bottom":"70px"}},$={key:0},ee={class:"form-group mt-4"},oe=o("label",{for:"profileData.userName"},"Nazwa użytkownika *",-1),te={class:"form-group mt-4"},se=o("label",{for:"profileData.city"},"Miejscowość",-1),ae={class:"form-group mt-4"},ne=o("label",{for:"profileData.description"},"Opis",-1),le={class:"form-group mt-4"},ie=o("label",{for:"profileData.favourite-places"},"Ulubione miejsca na wyjścia z psem",-1),re={class:"form-row"},ce={class:"col"},de=["onUpdate:modelValue"],ue={class:"col-auto"},me=["onClick"],pe={class:"form-group mt-4"},fe=o("label",{for:"dogs"},"Psy",-1),_e={class:"form-row mb-3"},ve={class:"col-sm-4"},he=["onUpdate:modelValue"],ge={class:"col-sm-4"},ye=["onUpdate:modelValue"],be={class:"col-sm-4"},De=["onUpdate:modelValue"],Ue={class:"col-auto"},ke=["onClick"],Ce={class:"form-group mt-4"},Ve=o("label",{for:"dogs"},"Psy",-1),Ie={class:"form-row mb-3"},we={class:"col"},xe=["onUpdate:modelValue"],Be={class:"col"},Pe=["onUpdate:modelValue"],je={class:"col"},Re=["onUpdate:modelValue"],Fe={class:"col-auto"},Ne=["onClick"],Se=["disabled"],ze={key:0};function Oe(n,s,u,e,g,m){const p=B("ImagePicker"),y=B("NavBarComponent");return i(),r(v,null,[o("div",Y,[e.profileData?(i(),r("div",$,[P(p),o("form",{onSubmit:s[7]||(s[7]=A((...t)=>e.saveChanges&&e.saveChanges(...t),["prevent"]))},[o("div",ee,[oe,c(o("input",{type:"text",class:"form-control",id:"name","onUpdate:modelValue":s[0]||(s[0]=t=>e.profileData.name=t),required:""},null,512),[[d,e.profileData.name]])]),o("div",te,[se,c(o("input",{type:"text",class:"form-control",id:"city","onUpdate:modelValue":s[1]||(s[1]=t=>e.profileData.city=t)},null,512),[[d,e.profileData.city]])]),o("div",ae,[ne,c(o("textarea",{class:"form-control",id:"description",rows:"3","onUpdate:modelValue":s[2]||(s[2]=t=>e.profileData.description=t)},null,512),[[d,e.profileData.description]])]),o("div",le,[ie,(i(!0),r(v,null,k(e.profileData.favourites,(t,l)=>(i(),r("div",{key:l},[o("div",re,[o("div",ce,[c(o("input",{type:"text",class:"form-control","onUpdate:modelValue":a=>e.profileData.favourites[l]=a},null,8,de),[[d,e.profileData.favourites[l]]])]),o("div",ue,[o("button",{type:"button",class:"btn btn-danger",onClick:a=>e.removePlace(l)},"Usuń",8,me)])])]))),128)),o("div",null,[o("button",{type:"button",class:"btn btn-success mt-2",onClick:s[3]||(s[3]=(...t)=>e.addPlace&&e.addPlace(...t))},"Dodaj miejsce")])]),o("div",pe,[fe,(i(!0),r(v,null,k(e.profileData.dogs,(t,l)=>(i(),r("div",{key:l},[o("div",_e,[o("div",ve,[c(o("input",{type:"text",class:"form-control",placeholder:"Imię","onUpdate:modelValue":a=>t.name=a},null,8,he),[[d,t.name]])]),o("div",ge,[c(o("input",{type:"text",class:"form-control",placeholder:"Rok urodzenia","onUpdate:modelValue":a=>t.yearOfBirth=a},null,8,ye),[[d,t.yearOfBirth]])]),o("div",be,[c(o("input",{type:"text",class:"form-control",placeholder:"Rasa","onUpdate:modelValue":a=>t.race=a},null,8,De),[[d,t.race]])]),o("div",Ue,[o("button",{type:"button",class:"btn btn-danger",onClick:a=>e.removeDog(l)},"Usuń",8,ke)])])]))),128)),o("div",null,[o("button",{type:"button",class:"btn btn-success mt-2",onClick:s[4]||(s[4]=(...t)=>e.addDog&&e.addDog(...t))},"Dodaj psa")])]),o("div",Ce,[Ve,(i(!0),r(v,null,k(e.profileData.dogs,(t,l)=>(i(),r("div",{key:l},[o("div",Ie,[o("div",we,[c(o("input",{type:"text",class:"form-control",placeholder:"Imię","onUpdate:modelValue":a=>t.name=a},null,8,xe),[[d,t.name]])]),o("div",Be,[c(o("input",{type:"text",class:"form-control",placeholder:"Rok urodzenia","onUpdate:modelValue":a=>t.yearOfBirth=a},null,8,Pe),[[d,t.yearOfBirth]])]),o("div",je,[c(o("input",{type:"text",class:"form-control",placeholder:"Rasa","onUpdate:modelValue":a=>t.race=a},null,8,Re),[[d,t.race]])]),o("div",Fe,[o("button",{type:"button",class:"btn btn-danger",onClick:a=>e.removeDog(l)},"Usuń",8,Ne)])])]))),128)),o("div",null,[o("button",{type:"button",class:"btn btn-success mt-2",onClick:s[5]||(s[5]=(...t)=>e.addDog&&e.addDog(...t))},"Dodaj psa")])]),o("button",{type:"submit",disabled:!e.isFormValid,class:"d-block mx-auto mt-3"},[o("img",{src:W,width:"150",onClick:s[6]||(s[6]=(...t)=>e.saveChanges&&e.saveChanges(...t))})],8,Se)],32)])):C("",!0)]),e.isUserRegistered?(i(),r("div",ze,[P(y)])):C("",!0)],64)}const Ae=j(X,[["render",Oe]]);export{Ae as default};
