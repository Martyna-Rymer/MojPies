import{_ as U,f as u,h as j,u as F,r as M,o as g,c as w,a as e,t as c,b as S,w as N,d as v,F as k,k as P,j as q,v as J,e as L}from"./index-d3e46547.js";import{J as A,a as x,d as b,g as C,r as K,s as V,e as B,f as E,S as H}from"./index-3872b343.js";import{N as O}from"./NavBarComponent-900ccc1e.js";const Y="/MojPies/assets/send_h-38d532ee.png";const $={components:{NavBarComponent:O},setup(){const h=u(""),d=u(),m=u(),t=u(),y=u(),R=0,_=s=>{const a=new Date(s.toMillis()),i=String(a.getDate()).padStart(2,"0"),o=String(a.getMonth()+1).padStart(2,"0"),D=a.getFullYear(),f=String(a.getHours()).padStart(2,"0"),T=String(a.getMinutes()).padStart(2,"0");return`${i}.${o}.${D} ${f}:${T}`},p=async s=>{const a=await A(s);return{name:a.data().name,id:a.id}};j(async()=>{const s=F();m.value=`forum/${s.params.sectionKey}/threads/${s.params.threadId}`,t.value=s.params.sectionKey,y.value=s.params.threadId;let a;const i=await A(x(b,`forum/${s.params.sectionKey}/threads/${s.params.threadId}`)),o=i.data(),D=o.answers.map(async n=>{const l=await p(n.author);return await C(K(V,`images/${l.id}`)).then(I=>{a=I}).catch(I=>{a="/MojPies/profile.png"}),{date:n.date,answer:n.answer,authorName:l.name,authorId:l.id,imageSrc:a}}).sort((n,l)=>new Date(n.date)-new Date(l.date)),f=await p(o.authorRef);await C(K(V,`images/${f.id}`)).then(n=>{a=n}).catch(n=>{a="/MojPies/profile.png"});const T={id:i.id,threadTopic:o.topic,threadDescription:o.description,threadAuthor:f,threadAuthorImg:a,threadStartDate:o.date,answers:await Promise.all(D)};d.value=T});const r=async()=>{const s=x(b,m.value);if(B.currentUser){const i=B.currentUser.uid,o=x(b,"users",i);await E(s,{answers:H({answer:h.value,date:new Date,author:o})});var a=new Audio("/MojPies/bark.mp3");a.play(),h.value="",console.log(t),this.uniqueKey+=1}};return{currentThread:d,formatDate:_,threadResponse:h,submitThreadResponse:async()=>{h.value.trim()!==""&&await r()},path:m,sectionKey:t,threadId:y,uniqueKey:R}}},z={class:"card mb-3",style:{width:"100%"}},G={class:"card-body"},Q={class:"card-title"},W={class:"card-text"},X={class:"card-text"},Z=["src"],tt={class:"text-muted"},at={class:"card mb-3",style:{width:"100%"}},et={class:"card-body"},st={class:"card-text"},rt={class:"card-text"},ot=["src"],nt={class:"text-muted"},dt=e("hr",{class:"m-0"},null,-1),ct={class:"card mb-3",style:{width:"100%"}},it={class:"card-body"};function ht(h,d,m,t,y,R){const _=M("router-link"),p=M("NavBarComponent");return g(),w(k,null,[t.currentThread?(g(),w("div",{class:"container",key:t.uniqueKey},[e("div",z,[e("div",G,[e("h5",Q,c(t.currentThread.threadTopic),1),e("p",W,c(t.currentThread.threadDescription),1),e("p",X,[S(_,{to:{name:"profile",params:{userId:t.currentThread.threadAuthor.id}}},{default:N(()=>[e("img",{src:t.currentThread.threadAuthorImg,class:"user-avatar rounded-circle",alt:"User avatar"},null,8,Z),v(" "+c(t.currentThread.threadAuthor.name),1)]),_:1},8,["to"]),v(", "),e("small",tt,c(t.formatDate(t.currentThread.threadStartDate)),1)])])]),(g(!0),w(k,null,P(t.currentThread.answers,r=>(g(),w("div",at,[e("div",et,[e("p",st,c(r.answer),1),e("p",rt,[S(_,{to:{name:"profile",params:{userId:r.authorId}}},{default:N(()=>[e("img",{src:r.imageSrc,class:"user-avatar rounded-circle",alt:"User avatar"},null,8,ot),v(" "+c(r.authorName),1)]),_:2},1032,["to"]),v(", "),e("small",nt,c(t.formatDate(r.date)),1)])]),dt]))),256)),e("div",ct,[e("div",it,[q(e("textarea",{"onUpdate:modelValue":d[0]||(d[0]=r=>t.threadResponse=r),class:"form-control w-100"},null,512),[[J,t.threadResponse]]),e("img",{class:"mt-3 d-block mx-auto",src:Y,width:"150",onClick:d[1]||(d[1]=(...r)=>t.submitThreadResponse&&t.submitThreadResponse(...r))})])])])):L("",!0),S(p)],64)}const pt=U($,[["render",ht]]);export{pt as default};
