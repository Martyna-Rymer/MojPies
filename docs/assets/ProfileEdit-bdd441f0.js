import{a as v,g as N,r as I,s as w,u as R,J as V,b,d as D,c as S}from"./index-ce0dfd1e.js";import{_ as j,e as _,f as F,o as l,c,a as o,g as U,p as z,h as E,i as M,u as O,j as L,r as x,b as P,k as A,l as m,v as p,F as k,m as B,n as J}from"./index-0683a8a5.js";import{N as Z}from"./NavBarComponent-c5356546.js";const q={setup(){const n=_(),t=_();return F(async()=>{if(v.currentUser){n.value=v.currentUser.uid;const i=document.getElementById("profile-image");N(I(w,`images/${v.currentUser.uid}`)).then(e=>{i.setAttribute("src",e)}).catch(e=>{i.setAttribute("src","/public/profile.png")})}}),{file:t,userId:n}},methods:{onFileSelected:function(n){this.file=n.target.files[0],console.log(this.file);let t=URL.createObjectURL(this.file);document.getElementById("profile-image").setAttribute("src",t)},uploadFile:function(){const n=I(w,`images/${this.userId}`);R(n,this.file).then(t=>{console.log("Załadowano plik")}),this.file=null}}},T=n=>(z("data-v-0225f772"),n=n(),E(),n),G={class:"text-center"},H=T(()=>o("div",{class:"text-center"},[o("img",{id:"profile-image",class:"card-img-top user-avatar rounded-circle mb-3"})],-1));function K(n,t,i,e,g,d){return l(),c("div",G,[H,o("input",{type:"file",onChange:t[0]||(t[0]=(...u)=>d.onFileSelected&&d.onFileSelected(...u))},null,32),e.file?(l(),c("button",{key:0,onClick:t[1]||(t[1]=(...u)=>d.uploadFile&&d.uploadFile(...u))},"Zapisz zdjęcie")):U("",!0)])}const Q=j(q,[["render",K],["__scopeId","data-v-0225f772"]]),W="/MojPies/assets/save_h-e6fdb895.png",X={components:{NavBarComponent:Z,ImagePicker:Q},setup(){const n=_(),t=_(),i=_(),e=M({id:null,name:"",city:"",description:"",favourites:[],dogs:[]});F(async()=>{const a=O();console.log(a.params.userId),n.value=a.params.userId;const f=(await V(b(D,`users/${a.params.userId}`))).data();e.id=a.params.userId,e.name=f.name,e.city=f.city,e.description=f.description,e.favourites=f.favourites||[],e.dogs=f.dogs||[],V(b(D,"users",v.currentUser.uid)).then(y=>{y.exists()?i.value=!0:i.value=!1}).catch(y=>{console.log(y)})});const g=()=>{e.dogs.push({name:"",yearOfBirth:"",race:""})},d=a=>{e.dogs.splice(a,1)},u=()=>{e.favourites.push("")},h=a=>{e.favourites.splice(a,1)},s=L(()=>e.name!="");async function r(){const a=b(D,"users",n.value);if(e.name!="")try{await S(a,{name:e.name,city:e.city,description:e.description,favourites:e.favourites,dogs:e.dogs}),console.log("Changes saved successfully!"),J.push({name:"profile",params:{userId:n.value}})}catch(C){console.log("Error saving changes: ",C)}else alert("Proszę wypełnić wymagane pola")}return{userId:n,initialUrl:t,profileData:e,addDog:g,removeDog:d,addPlace:u,removePlace:h,saveChanges:r,isFormValid:s,isUserRegistered:i}}},Y={class:"container ml-2 me-2",style:{"margin-bottom":"70px"}},$={key:0},ee={class:"form-group mt-3"},oe=o("label",{for:"profileData.userName"},"Nazwa użytkownika *",-1),te={class:"form-group mt-3"},se=o("label",{for:"profileData.city"},"Miejscowość",-1),ae={class:"form-group mt-3"},ne=o("label",{for:"profileData.description"},"Opis",-1),ie={class:"form-group mt-3"},re=o("label",{for:"profileData.favourite-places"},"Ulubione miejsca na wyjścia z psem",-1),le={class:"form-row"},ce={class:"col"},de=["onUpdate:modelValue"],ue={class:"col-auto"},me=["onClick"],pe={class:"form-group mt-3"},fe=o("label",{for:"dogs"},"Psy",-1),_e={class:"form-row"},ve={class:"col"},ge=["onUpdate:modelValue"],he={class:"col"},ye=["onUpdate:modelValue"],be={class:"col"},De=["onUpdate:modelValue"],ke={class:"col-auto"},Ue=["onClick"],Ce=["disabled"],Ie={key:0};function we(n,t,i,e,g,d){const u=x("ImagePicker"),h=x("NavBarComponent");return l(),c(k,null,[o("div",Y,[e.profileData?(l(),c("div",$,[P(u),o("form",{onSubmit:t[6]||(t[6]=A((...s)=>e.saveChanges&&e.saveChanges(...s),["prevent"]))},[o("div",ee,[oe,m(o("input",{type:"text",class:"form-control",id:"name","onUpdate:modelValue":t[0]||(t[0]=s=>e.profileData.name=s),required:""},null,512),[[p,e.profileData.name]])]),o("div",te,[se,m(o("input",{type:"text",class:"form-control",id:"city","onUpdate:modelValue":t[1]||(t[1]=s=>e.profileData.city=s)},null,512),[[p,e.profileData.city]])]),o("div",ae,[ne,m(o("textarea",{class:"form-control",id:"description",rows:"3","onUpdate:modelValue":t[2]||(t[2]=s=>e.profileData.description=s)},null,512),[[p,e.profileData.description]])]),o("div",ie,[re,(l(!0),c(k,null,B(e.profileData.favourites,(s,r)=>(l(),c("div",{key:r},[o("div",le,[o("div",ce,[m(o("input",{type:"text",class:"form-control","onUpdate:modelValue":a=>e.profileData.favourites[r]=a},null,8,de),[[p,e.profileData.favourites[r]]])]),o("div",ue,[o("button",{type:"button",class:"btn btn-danger",onClick:a=>e.removePlace(r)},"Usuń",8,me)])])]))),128)),o("div",null,[o("button",{type:"button",class:"btn btn-success mt-2",onClick:t[3]||(t[3]=(...s)=>e.addPlace&&e.addPlace(...s))},"Dodaj miejsce")])]),o("div",pe,[fe,(l(!0),c(k,null,B(e.profileData.dogs,(s,r)=>(l(),c("div",{key:r},[o("div",_e,[o("div",ve,[m(o("input",{type:"text",class:"form-control",placeholder:"Imię","onUpdate:modelValue":a=>s.name=a},null,8,ge),[[p,s.name]])]),o("div",he,[m(o("input",{type:"text",class:"form-control",placeholder:"Rok urodzenia","onUpdate:modelValue":a=>s.yearOfBirth=a},null,8,ye),[[p,s.yearOfBirth]])]),o("div",be,[m(o("input",{type:"text",class:"form-control",placeholder:"Rasa","onUpdate:modelValue":a=>s.race=a},null,8,De),[[p,s.race]])]),o("div",ke,[o("button",{type:"button",class:"btn btn-danger",onClick:a=>e.removeDog(r)},"Usuń",8,Ue)])])]))),128)),o("div",null,[o("button",{type:"button",class:"btn btn-success mt-2",onClick:t[4]||(t[4]=(...s)=>e.addDog&&e.addDog(...s))},"Dodaj psa")])]),o("button",{type:"submit",disabled:!e.isFormValid,class:"d-block mx-auto mt-3"},[o("img",{src:W,width:"150",onClick:t[5]||(t[5]=(...s)=>e.saveChanges&&e.saveChanges(...s))})],8,Ce)],32)])):U("",!0)]),e.isUserRegistered?(l(),c("div",Ie,[P(h)])):U("",!0)],64)}const Be=j(X,[["render",we]]);export{Be as default};
