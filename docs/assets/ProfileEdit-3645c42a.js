import{a as g,g as B,r as y,s as b,u as P,J as j,b as D,d as k,c as N}from"./index-ce0dfd1e.js";import{_ as w,e as f,f as V,o as l,c,a as e,g as x,p as S,h as F,i as R,u as z,r as U,b as C,j as E,k as m,v as p,F as h,l as I,m as M}from"./index-7265ed9c.js";import{N as O}from"./NavBarComponent-ae475344.js";const L={setup(){const n=f(),s=f();return V(async()=>{if(g.currentUser){n.value=g.currentUser.uid;const a=document.getElementById("profile-image");B(y(b,`images/${g.currentUser.uid}`)).then(t=>{a.setAttribute("src",t)}).catch(t=>{a.setAttribute("src","/public/profile.png")})}}),{file:s,userId:n}},methods:{onFileSelected:function(n){this.file=n.target.files[0],console.log(this.file);let s=URL.createObjectURL(this.file);document.getElementById("profile-image").setAttribute("src",s)},uploadFile:function(){const n=y(b,`images/${this.userId}`);P(n,this.file).then(s=>{console.log("Załadowano plik")}),this.file=null}}},A=n=>(S("data-v-ce7650db"),n=n(),F(),n),J={class:"text-center"},Z=A(()=>e("div",{class:"text-center"},[e("img",{id:"profile-image",class:"card-img-top user-avatar rounded-circle mb-3"})],-1));function q(n,s,a,t,_,d){return l(),c("div",J,[Z,e("input",{type:"file",accept:"image/*",capture:"camera",onChange:s[0]||(s[0]=(...u)=>d.onFileSelected&&d.onFileSelected(...u))},null,32),t.file?(l(),c("button",{key:0,onClick:s[1]||(s[1]=(...u)=>d.uploadFile&&d.uploadFile(...u))},"Zapisz zdjęcie")):x("",!0)])}const T=w(L,[["render",q],["__scopeId","data-v-ce7650db"]]),G="/MojPies/assets/save_h-e6fdb895.png",H={components:{NavBarComponent:O,ImagePicker:T},setup(){const n=f(),s=f(),a=R({id:null,name:"",city:"",description:"",favourites:[],dogs:[]});V(async()=>{const o=z();console.log(o.params.userId),n.value=o.params.userId;const i=(await j(D(k,`users/${o.params.userId}`))).data();a.id=o.params.userId,a.name=i.name,a.city=i.city,a.description=i.description,a.favourites=i.favourites||[],a.dogs=i.dogs||[]});const t=()=>{a.dogs.push({name:"",yearOfBirth:"",race:""})},_=o=>{a.dogs.splice(o,1)},d=()=>{a.favourites.push("")},u=o=>{a.favourites.splice(o,1)};async function v(){const o=D(k,"users",n.value);try{await N(o,{name:a.name,city:a.city,description:a.description,favourites:a.favourites,dogs:a.dogs}),console.log("Changes saved successfully!"),M.push({name:"profile",params:{userId:n.value}})}catch(r){console.log("Error saving changes: ",r)}}return{userId:n,initialUrl:s,profileData:a,addDog:t,removeDog:_,addPlace:d,removePlace:u,saveChanges:v}}},K={class:"container ml-2 me-2",style:{"margin-bottom":"70px"}},Q={key:0},W={class:"form-group"},X=e("label",{for:"profileData.userName"},"Nazwa użytkownika",-1),Y={class:"form-group"},$=e("label",{for:"profileData.city"},"Miejscowość",-1),ee={class:"form-group"},oe=e("label",{for:"profileData.description"},"Opis",-1),te={class:"form-group"},se=e("label",{for:"profileData.favourite-places"},"Ulubione miejsca na wyjścia z psem",-1),ae={class:"form-row"},ne={class:"col"},ie=["onUpdate:modelValue"],re={class:"col-auto"},le=["onClick"],ce={class:"form-group"},de=e("label",{for:"dogs"},"Psy",-1),ue={class:"form-row"},me={class:"col"},pe=["onUpdate:modelValue"],fe={class:"col"},_e=["onUpdate:modelValue"],ve={class:"col"},ge=["onUpdate:modelValue"],he={class:"col-auto"},ye=["onClick"],be={type:"submit",class:"d-block mx-auto mt-3"};function De(n,s,a,t,_,d){const u=U("ImagePicker"),v=U("NavBarComponent");return l(),c(h,null,[e("div",K,[t.profileData?(l(),c("div",Q,[C(u),e("form",{onSubmit:s[6]||(s[6]=E((...o)=>t.saveChanges&&t.saveChanges(...o),["prevent"]))},[e("div",W,[X,m(e("input",{type:"text",class:"form-control",id:"name","onUpdate:modelValue":s[0]||(s[0]=o=>t.profileData.name=o),required:""},null,512),[[p,t.profileData.name]])]),e("div",Y,[$,m(e("input",{type:"text",class:"form-control",id:"city","onUpdate:modelValue":s[1]||(s[1]=o=>t.profileData.city=o)},null,512),[[p,t.profileData.city]])]),e("div",ee,[oe,m(e("textarea",{class:"form-control",id:"description",rows:"3","onUpdate:modelValue":s[2]||(s[2]=o=>t.profileData.description=o)},null,512),[[p,t.profileData.description]])]),e("div",te,[se,(l(!0),c(h,null,I(t.profileData.favourites,(o,r)=>(l(),c("div",{key:r},[e("div",ae,[e("div",ne,[m(e("input",{type:"text",class:"form-control","onUpdate:modelValue":i=>t.profileData.favourites[r]=i},null,8,ie),[[p,t.profileData.favourites[r]]])]),e("div",re,[e("button",{type:"button",class:"btn btn-danger",onClick:i=>t.removePlace(r)},"Usuń",8,le)])])]))),128)),e("div",null,[e("button",{type:"button",class:"btn btn-success mt-2",onClick:s[3]||(s[3]=(...o)=>t.addPlace&&t.addPlace(...o))},"Dodaj miejsce")])]),e("div",ce,[de,(l(!0),c(h,null,I(t.profileData.dogs,(o,r)=>(l(),c("div",{key:r},[e("div",ue,[e("div",me,[m(e("input",{type:"text",class:"form-control",placeholder:"Imię","onUpdate:modelValue":i=>o.name=i},null,8,pe),[[p,o.name]])]),e("div",fe,[m(e("input",{type:"text",class:"form-control",placeholder:"Rok urodzenia","onUpdate:modelValue":i=>o.yearOfBirth=i},null,8,_e),[[p,o.yearOfBirth]])]),e("div",ve,[m(e("input",{type:"text",class:"form-control",placeholder:"Rasa","onUpdate:modelValue":i=>o.race=i},null,8,ge),[[p,o.race]])]),e("div",he,[e("button",{type:"button",class:"btn btn-danger",onClick:i=>t.removeDog(r)},"Usuń",8,ye)])])]))),128)),e("div",null,[e("button",{type:"button",class:"btn btn-success mt-2",onClick:s[4]||(s[4]=(...o)=>t.addDog&&t.addDog(...o))},"Dodaj psa")])]),e("button",be,[e("img",{src:G,width:"150",onClick:s[5]||(s[5]=(...o)=>t.saveChanges&&t.saveChanges(...o))})])],32)])):x("",!0)]),C(v)],64)}const Ie=w(H,[["render",De]]);export{Ie as default};
