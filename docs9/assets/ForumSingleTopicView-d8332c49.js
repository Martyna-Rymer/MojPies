import{_ as P,e as g,f as U,u as j,r as k,o as w,c as f,a as r,t as i,b as y,w as C,d as v,F as V,l as F,k as $,v as J,g as K}from"./index-37a7a3e6.js";import{J as S,b as T,d as b,g as x,r as R,s as M,a as B,f as L,S as E,n as H}from"./index-ce0dfd1e.js";import{N as O}from"./NavBarComponent-2bafd9cb.js";const Y="/MojPies/assets/send_h-38d532ee.png";const q={components:{NavBarComponent:O},setup(){const h=g(""),d=g(),_=g(),a=g([]),N=t=>{const e=new Date(t.toMillis()),o=String(e.getDate()).padStart(2,"0"),s=String(e.getMonth()+1).padStart(2,"0"),c=e.getFullYear(),l=String(e.getHours()).padStart(2,"0"),u=String(e.getMinutes()).padStart(2,"0");return`${o}.${s}.${c} ${l}:${u}`},D=async t=>{const e=await S(t);return{name:e.data().name,id:e.id}};U(async()=>{const t=j();_.value=`forum/${t.params.sectionKey}/threads/${t.params.threadId}`;let e;const o=await S(T(b,`forum/${t.params.sectionKey}/threads/${t.params.threadId}`)),s=o.data(),c=s.answers.map(async n=>{const m=await D(n.author);return await x(R(M,`images/${m.id}`)).then(I=>{e=I}).catch(I=>{e="/MojPies/profile.png"}),{date:n.date,answer:n.answer,authorName:m.name,authorId:m.id,imageSrc:e}}).sort((n,m)=>new Date(n.date)-new Date(m.date)),l=await D(s.authorRef);await x(R(M,`images/${l.id}`)).then(n=>{e=n}).catch(n=>{e="/MojPies/profile.png"});const u={id:o.id,threadTopic:s.topic,threadDescription:s.description,threadAuthor:l,threadAuthorImg:e,threadStartDate:s.date};d.value=u,a.value=await Promise.all(c)});const p=async()=>{const t=T(b,_.value);if(B.currentUser){const o=B.currentUser.uid,s=T(b,"users",o);await L(t,{answers:E({answer:h.value,date:new Date,author:s})});var e=new Audio("/MojPies/bark.mp3");e.play();let c;await x(R(M,`images/${o}`)).then(u=>{c=u}).catch(u=>{c="/MojPies/profile.png"});let l=await S(s);a.value.push({date:H.fromDate(new Date),answer:h.value,authorName:l.data().name,authorId:o,imageSrc:c}),h.value=""}};return{currentThread:d,formatDate:N,threadResponse:h,submitThreadResponse:async()=>{h.value.trim()!==""&&await p()},path:_,threadAnswers:a}}},z={key:0,class:"container"},G={class:"card mb-3",style:{width:"100%"}},Q={class:"card-body"},W={class:"card-title"},X={class:"card-text"},Z={class:"card-text"},tt=["src"],at={class:"text-muted"},et={class:"card mb-3",style:{width:"100%"}},rt={class:"card-body"},st={class:"card-text"},ot={class:"card-text"},nt=["src"],dt={class:"text-muted"},ct=r("hr",{class:"m-0"},null,-1),it={class:"card mb-3",style:{width:"100%"}},ht={class:"card-body"};function lt(h,d,_,a,N,D){const p=k("router-link"),A=k("NavBarComponent");return w(),f(V,null,[a.currentThread?(w(),f("div",z,[r("div",G,[r("div",Q,[r("h5",W,i(a.currentThread.threadTopic),1),r("p",X,i(a.currentThread.threadDescription),1),r("p",Z,[y(p,{to:{name:"profile",params:{userId:a.currentThread.threadAuthor.id}}},{default:C(()=>[r("img",{src:a.currentThread.threadAuthorImg,class:"user-avatar rounded-circle",alt:"User avatar"},null,8,tt),v(" "+i(a.currentThread.threadAuthor.name),1)]),_:1},8,["to"]),v(", "),r("small",at,i(a.formatDate(a.currentThread.threadStartDate)),1)])])]),(w(!0),f(V,null,F(a.threadAnswers,t=>(w(),f("div",et,[r("div",rt,[r("p",st,i(t.answer),1),r("p",ot,[y(p,{to:{name:"profile",params:{userId:t.authorId}}},{default:C(()=>[r("img",{src:t.imageSrc,class:"user-avatar rounded-circle",alt:"User avatar"},null,8,nt),v(" "+i(t.authorName),1)]),_:2},1032,["to"]),v(", "),r("small",dt,i(a.formatDate(t.date)),1)])]),ct]))),256)),r("div",it,[r("div",ht,[$(r("textarea",{"onUpdate:modelValue":d[0]||(d[0]=t=>a.threadResponse=t),class:"form-control w-100"},null,512),[[J,a.threadResponse]]),r("img",{class:"mt-3 d-block mx-auto",src:Y,width:"150",onClick:d[1]||(d[1]=(...t)=>a.submitThreadResponse&&a.submitThreadResponse(...t))})])])])):K("",!0),y(A)],64)}const pt=P(q,[["render",lt]]);export{pt as default};
